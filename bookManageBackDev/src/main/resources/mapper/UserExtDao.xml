<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.Httb.bookManage.dao.UserExtDao">

<!--    用户登录 根据username,password-->
    <select id="selectUserByUP" resultMap="com.Httb.bookManage.mbg.dao.UserDao.BaseResultMap" parameterType="com.Httb.bookManage.mbg.entity.User">
        select
        <include refid="com.Httb.bookManage.mbg.dao.UserDao.Base_Column_List"/>
        from user
        <where>
            username = #{username}
            and password = MD5(#{password})
        </where>
    </select>

<!--    通过用户名查询用户-->
    <select id="selectUserByUsername" parameterType="java.lang.String" resultMap="com.Httb.bookManage.mbg.dao.UserDao.BaseResultMap">
        select
        <include refid="com.Httb.bookManage.mbg.dao.UserDao.Base_Column_List"/>
        from user
        <where>
            username = #{username}
        </where>
    </select>

<!--    查找用户-->
    <select id="selectUser" parameterType="com.Httb.bookManage.mbg.entity.User" resultMap="com.Httb.bookManage.mbg.dao.UserDao.BaseResultMap">
        select
        <include refid="com.Httb.bookManage.mbg.dao.UserDao.Base_Column_List"/>
        from user
        <where>
            <trim prefixOverrides="and">
                <if test="id != null">
                    id = #{id}
                </if>
                <if test="username != null">
                    and username = #{username}
                </if>
                <if test="nickname != null">
                    and nickname = #{nickname}
                </if>
                <if test="password != null">
                    and password = #{password}
                </if>
                <if test="tel != null">
                    and tel = #{tel}
                </if>
                <if test="email != null">
                    and email = #{email}
                </if>
            </trim>
        </where>
    </select>

<!--    用户注册 用户插入 密码加密-->
    <insert id="insertUser" parameterType="com.Httb.bookManage.mbg.entity.User">
        insert into user
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="username != null">
                username,
            </if>
            <if test="nickname != null">
                nickname,
            </if>
            <if test="password != null">
                `password`,
            </if>
            <if test="head != null">
                head,
            </if>
            <if test="tel != null">
                tel,
            </if>
            <if test="email != null">
                email,
            </if>
            <if test="status != null">
                `status`,
            </if>
            <if test="isSuper != null">
                is_super,
            </if>
        </trim>
        <trim prefix="values (" suffix=")" suffixOverrides=",">
            <if test="username != null">
                #{username,jdbcType=VARCHAR},
            </if>
            <if test="nickname != null">
                #{nickname,jdbcType=VARCHAR},
            </if>
            <if test="password != null">
                MD5(#{password,jdbcType=VARCHAR}),
            </if>
            <if test="head != null">
                #{head,jdbcType=VARCHAR},
            </if>
            <if test="tel != null">
                #{tel,jdbcType=VARCHAR},
            </if>
            <if test="email != null">
                #{email,jdbcType=VARCHAR},
            </if>
            <if test="status != null">
                #{status,jdbcType=BOOLEAN},
            </if>
            <if test="isSuper != null">
                #{isSuper,jdbcType=BOOLEAN},
            </if>
        </trim>
    </insert>
</mapper>